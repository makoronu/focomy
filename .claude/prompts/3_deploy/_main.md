# デプロイ

**PyPI + Fly.io への公開**

---

## 必須ルール

1. **デプロイ前にユーザー確認必須**（勝手にデプロイ禁止）
2. **プロトコル違反チェック必須**（違反あれば停止→通知）

---

## 実行順序

### 1. 準備
```
→ 1_prepare/version.md
→ 1_prepare/changelog.md
```

### 2. ビルド
```
→ 2_build/test.md
→ 2_build/build.md
```

### 3. プロトコル違反チェック（公開前必須）

以下を確認、1つでも違反があれば**即停止→ユーザーに報告**：

- [ ] ENUM使用なし
- [ ] ハードコーディングなし
- [ ] 例外握りつぶしなし
- [ ] N+1クエリなし
- [ ] XSS/SQLインジェクション対策済み
- [ ] セキュリティ考慮済み

### 4. ユーザー確認（公開前必須）

```
【デプロイ確認】
- バージョン: x.x.x
- 変更内容: [概要]
- プロトコル違反: なし

デプロイしてよいですか？
```

**承認を得るまで次に進まない**

### 5. 公開
```
→ 3_publish/pypi.md
→ 3_publish/fly.md
```

### 6. 検証
```
→ 4_verify/pip_test.md
→ 4_verify/log.md
```

---

## 完了時

```bash
afplay /System/Library/Sounds/Glass.aiff
```

```
━━━━━━━━━━━━━━━━━━━━
【デプロイ】完了
━━━━━━━━━━━━━━━━━━━━
✓ PyPI: focomy x.x.x
✓ Fly.io: focomy-cms

【次】→ 4_retrospective/_main.md
━━━━━━━━━━━━━━━━━━━━
```
